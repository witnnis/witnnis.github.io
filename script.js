/*********************************
 * üìù Ìé∏ÏßÄ Îç∞Ïù¥ÌÑ∞ (10Í∞ú ÎçîÎØ∏)
 *********************************/
const letters = [
  {
    type: "letter",
    nickname: "ÏúóÎãàÎãù",
    content: "ÏïàÎÖï ÏúóÎãàÎì§ÏïÑ Î≤åÏç® ÏúóÎãàÎì§Ïù¥Îûë Î≥¥ÎÇ¥Îäî ÎëêÎ≤àÏß∏ ÌÅ¨Î¶¨Ïä§ÎßàÏä§ÏïºüéÑ ÏãúÍ∞ÑÏù¥ ÎÑàÎ¨¥ Îπ®ÎùºÏÑú Ï†ïÎßê ÎØøÍ≤®Í∞Ä ÏïàÎèº‚Ä¶ ÏúóÎãà ÏúÑÏãúÎûë Ìï®ÍªòÌïú ÏùºÎÖÑÏù¥ Ïù¥Î†áÍ≤å Îπ†Î•¥Îã§Îãà ÎÑàÎ¨¥ Ïû¨Î∞åÏñ¥ÏÑú Í∑∏Îü∞Í±∞Í≤†ÏßÄ?! Îπ†Î•¥Í∏¥ ÌñàÏßÄÎßå ÎèåÏïÑÎ≥¥Î©¥ Ï∂îÏñµ ÏßÑÏßú ÌïúÍ∞ÄÎìùÏù¥Îã§ ÎÇ¥ÎÖÑÏóêÎèÑ Ïûò Î∂ÄÌÉÅÌï¥ü©∑üíö ÎÇò ÏúóÎã¨Ïù¥ ÎÑàÎ¨¥ Ï¢ãÏïÑÏÑú Ïò§ÎûòÏò§Îûò ÏûàÍ≥† Ïã∂Ïñ¥ Ïò¨Ìï¥ÎèÑ ÏàòÍ≥† ÎßéÏïòÍ≥† ÎÇ¥ÎÖÑÏóî Îçî Ï¢ãÏùÄ ÏùºÎì§Îßå Í∞ÄÎìùÌñàÏúºÎ©¥ Ï¢ãÍ≤†Îã§ ÏúóÎãàÎì§ÏïÑ ÏÇ¨ÎûëÌòÄ ÏïûÎãàÎèÑ ÏÇ¨ÎûëÌõºü¶∑ü´∂ü™Ω"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 2",
    content: "Îî∞ÎúªÌïú Ïó∞Îßê Î≥¥ÎÇ¥ÏÑ∏Ïöî. Ìï≠ÏÉÅ ÏùëÏõêÌï©ÎãàÎã§ üíå"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 3",
    content: "Ìï®ÍªòÌï¥ÏÑú ÌñâÎ≥µÌïú Ìïú Ìï¥ÏòÄÏñ¥Ïöî! ‚ùÑÔ∏è"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 4",
    content: "ÏÉàÌï¥ Î≥µ ÎßéÏù¥ Î∞õÏúºÏÑ∏Ïöî~ üéÅ"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 5",
    content: "Ïò¨Ìï¥ÎèÑ Ìï®ÍªòÌï¥Ï§òÏÑú Í≥†ÎßàÏõåÏöî üåü"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 6",
    content: "ÏÜåÏ§ëÌïú Ï∂îÏñµÎì§ Í∞êÏÇ¨Ìï©ÎãàÎã§ üéÑ"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 7",
    content: "Ïñ∏Ï†úÎÇò ÌñâÎ≥µÌïòÍ∏∏ Î∞îÎùºÏöî üíö"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 8",
    content: "Îî∞ÎúªÌïú Í≤®Ïö∏ ÎêòÏÑ∏Ïöî! ‚ùÑÔ∏è"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 9",
    content: "ÌñâÎ≥µÌïú ÌÅ¨Î¶¨Ïä§ÎßàÏä§ Î≥¥ÎÇ¥Ïöî üéÖ"
  },
  {
    type: "letter",
    nickname: "ÏùµÎ™Ö ÏãúÏ¶àÎãà 10",
    content: "ÎÇ¥ÎÖÑÏóêÎèÑ Ìï®ÍªòÌï¥Ïöî! üéÑ"
  }
];

/*********************************
 * üéÅ Ïä§Ìã∞Ïª§ Îç∞Ïù¥ÌÑ∞
 *********************************/
const stickers = [
  // Ïú†ÌäúÎ∏å ÎßÅÌÅ¨ ÏûàÎäî ÏÑ†Î¨º Ïä§Ìã∞Ïª§Îì§
  { 
    type: "sticker",
    img: "assets/sticker-gift.png", 
    link: "https://www.youtube.com/watch?v=DITu2nhnbtk" 
  },
  { 
    type: "sticker",
    img: "assets/sticker-gift.png", 
    link: "https://www.youtube.com/watch?v=n1q3XgM9_cQ" 
  },
  { 
    type: "sticker",
    img: "assets/sticker-gift.png", 
    link: "https://www.youtube.com/watch?v=OMbQlLCmw84" 
  },
  { 
    type: "sticker",
    img: "assets/sticker-gift.png", 
    link: "https://www.youtube.com/watch?v=YfiZORcr8uw" 
  },
  { 
    type: "sticker",
    img: "assets/sticker-gift.png", 
    link: "https://www.youtube.com/shorts/0ztMa7rtkO4" 
  },
  
  // Í∑∏ÎÉ• Ïû•ÏãùÏö© Ïä§Ìã∞Ïª§Îì§ (ÎßÅÌÅ¨ ÏóÜÏùå)
  { 
    type: "sticker",
    img: "assets/sticker-tree.png" 
  },
  { 
    type: "sticker",
    img: "assets/sticker-snowman.png" 
  },
  { 
    type: "sticker",
    img: "assets/sticker-star.png" 
  }
];

/*********************************
 * üé≤ Ìé∏ÏßÄÏôÄ Ïä§Ìã∞Ïª§ ÎûúÎç§ ÏÑûÍ∏∞
 *********************************/
const items = [...letters];

// Ïä§Ìã∞Ïª§Î•º ÎûúÎç§ ÏúÑÏπòÏóê ÏÇΩÏûÖ
stickers.forEach(sticker => {
  const randomIndex = Math.floor(Math.random() * (items.length + 1));
  items.splice(randomIndex, 0, sticker);
});

/*********************************
 * üé® ÏïÑÏù¥ÌÖú Î†åÎçîÎßÅ
 *********************************/
const grid = document.getElementById("grid");
const overlay = document.getElementById("overlay");

items.forEach(item => {
  const el = document.createElement("div");
  el.className = "item";

  if (item.type === "letter") {
    // Ìé∏ÏßÄ Î¥âÌà¨
    el.style.backgroundImage = "url('assets/envelope.png')";
    el.onclick = () => openLetter(item, el);
  } 
  else if (item.type === "sticker") {
    // Ïä§Ìã∞Ïª§
    el.style.backgroundImage = `url('${item.img}')`;
    
    // ÎßÅÌÅ¨Í∞Ä ÏûàÏúºÎ©¥ ÌÅ¥Î¶≠ Ïãú ÏÉà ÌÉ≠ÏóêÏÑú Ïó¥Í∏∞
    if (item.link) {
      el.onclick = () => window.open(item.link, "_blank");
      el.style.cursor = "pointer";
    } else {
      el.style.cursor = "default";
    }
  }

  grid.appendChild(el);
});

/*********************************
 * üíå Ìé∏ÏßÄ Ïó¥Í∏∞/Îã´Í∏∞
 *********************************/
function openLetter(letter, element) {
  document.getElementById("nickname").textContent = letter.nickname;
  document.getElementById("content").textContent = letter.content;
  overlay.classList.remove("hidden");
  
  // ÏùΩÏùÄ Ìé∏ÏßÄ ÌëúÏãú
  element.classList.add("read");
}

function closeLetter() {
  overlay.classList.add("hidden");
}

// Îã´Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠
document.getElementById("closeBtn").onclick = (e) => {
  e.stopPropagation();
  closeLetter();
};

// Î∞∞Í≤Ω ÌÅ¥Î¶≠Ìï¥ÎèÑ Îã´Í∏∞
overlay.onclick = (e) => {
  if (e.target === overlay) {
    closeLetter();
  }
};

/*********************************
 * ‚è≥ Î°úÎî© ÌôîÎ©¥ Ï≤òÎ¶¨
 *********************************/
setTimeout(() => {
  document.getElementById("loading").classList.add("hidden");
  document.getElementById("main").classList.remove("hidden");
}, 2600);

/*********************************
 * ‚ùÑÔ∏è Îàà Ìö®Í≥º
 *********************************/
const snowContainer = document.getElementById("snow");
for (let i = 0; i < 50; i++) {
  const snowflake = document.createElement("span");
  snowflake.textContent = "‚ùÑ";
  snowflake.style.left = Math.random() * 100 + "vw";
  snowflake.style.animationDuration = (5 + Math.random() * 5) + "s";
  snowflake.style.animationDelay = Math.random() * 3 + "s";
  snowflake.style.fontSize = (10 + Math.random() * 6) + "px";
  snowContainer.appendChild(snowflake);
}


